
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simple Lending DApp</title>
<style>
  body { font-family: sans-serif; padding: 20px; background: #eef; }
  h2 { color: #333; }
  input, button { margin: 5px 0; width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc; }
  button { background: #007acc; color: white; border: none; cursor: pointer; }
  button:hover { background: #005fa3; }
  #account { margin-top: 10px; font-weight: bold; }
</style>
</head>
<body>
<h2>Simple Lending DApp</h2>

<button onclick="connectWallet()">Connect MetaMask</button>
<p id="account"></p>

<h4>Offer Loan</h4>
<input id="loanAmount" placeholder="Loan amount in ETH" />
<input id="collateralAmount" placeholder="Collateral required in ETH" />
<button onclick="offerLoan()">Offer Loan</button>

<h4>Take Loan</h4>
<input id="collateralToSend" placeholder="Collateral to send in ETH" />
<button onclick="takeLoan()">Take Loan</button>

<h4>Repay Loan</h4>
<input id="repayAmount" placeholder="Repay amount in ETH" />
<button onclick="repayLoan()">Repay Loan</button>

<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script>
let provider, signer, contract;

// ✅ Your contract address and ABI:
const contractAddress = "0x44C2bd9BA02cc1266ebd823de9699125C2Da915C";
const contractABI = [
	{
		"inputs": [{"internalType": "uint256","name": "_collateral","type": "uint256"}],
		"name": "offerLoan","outputs": [],"stateMutability": "payable","type": "function"
	},
	{"inputs": [],"name": "repayLoan","outputs": [],"stateMutability": "payable","type": "function"},
	{"inputs": [],"name": "takeLoan","outputs": [],"stateMutability": "payable","type": "function"},
	{
		"inputs": [],
		"name": "loan",
		"outputs": [
			{"internalType": "address payable","name": "lender","type": "address"},
			{"internalType": "address payable","name": "borrower","type": "address"},
			{"internalType": "uint256","name": "amount","type": "uint256"},
			{"internalType": "uint256","name": "collateral","type": "uint256"},
			{"internalType": "bool","name": "taken","type": "bool"},
			{"internalType": "bool","name": "repaid","type": "bool"}
		],
		"stateMutability": "view",
		"type": "function"
	}
];

async function connectWallet() {
  if (window.ethereum) {
    try {
      provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      signer = provider.getSigner();
      contract = new ethers.Contract(contractAddress, contractABI, signer);
      const account = await signer.getAddress();
      document.getElementById("account").innerText = "✅ Connected: " + account;
    } catch (error) {
      console.error(error);
      alert("❌ Failed to connect MetaMask.");
    }
  } else {
    alert("❗ Please install MetaMask!");
  }
}

async function offerLoan() {
  const amount = ethers.utils.parseEther(document.getElementById('loanAmount').value);
  const collateral = ethers.utils.parseEther(document.getElementById('collateralAmount').value);
  try {
    const tx = await contract.offerLoan(collateral, { value: amount });
    await tx.wait();
    alert("✅ Loan offered!");
  } catch (e) {
    console.error(e);
    alert("❌ Failed to offer loan.");
  }
}

async function takeLoan() {
  const collateral = ethers.utils.parseEther(document.getElementById('collateralToSend').value);
  try {
    const tx = await contract.takeLoan({ value: collateral });
    await tx.wait();
    alert("✅ Loan taken!");
  } catch (e) {
    console.error(e);
    alert("❌ Failed to take loan.");
  }
}

async function repayLoan() {
  const amount = ethers.utils.parseEther(document.getElementById('repayAmount').value);
  try {
    const tx = await contract.repayLoan({ value: amount });
    await tx.wait();
    alert("✅ Loan repaid!");
  } catch (e) {
    console.error(e);
    alert("❌ Failed to repay loan.");
  }
}
</script>
</body>
</html>



